merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=3)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=100)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=30)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=-2, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=1, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=40, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=400, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(aes(y=..density..), binwidth=30, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(binwidth=30, alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_ipsum()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = -log10(centroid_distances/Area.µm.2))
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = log1p(centroid_distances/Area.µm.2))
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = log2(centroid_distances/Area.µm.2))
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = -log2(centroid_distances/Area.µm.2))
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = -log10(centroid_distances/Area.µm.2))
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
ggtitle("Bin size = 3") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen") +
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_density(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
theme_clean()
merged_scaled  %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(aes(xintercept=mean(centroid_distances_scaled)),
color="blue", linetype="dashed", size=1) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distrbution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(aes(xintercept=mean(centroid_distances_scaled)),
color="blue", linetype="dashed", size=1) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(aes(xintercept=mean(centroid_distances_scaled)),
color="blue", linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
mean_centroid_distance <- plyr::ddply(merged_scaled, condition, summarise, grp.mean=mean(centroid_distances_scaled))
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color="blue", linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#72D8FF"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = centroid_distances))
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = centroid_distances)
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#72D8FF"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#6BB2CD"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
## Zero center all abdomen centroids and scale hemocyte centroids in each abdomen
merged_scaled <- merged  %>%
mutate("Centroid_X_hm_scaled" = Centroid_X_hm - Centroid_X_ab) %>%
mutate("Centroid_Y_hm_scaled" = Centroid_Y_hm - Centroid_Y_ab) %>%
select(Image_ab,Centroid_X_hm_scaled,Centroid_Y_hm_scaled,condition,centroid_distances, Area.µm.2)
### Zero-scaled centroid distances without area-normalization or log-scaling.
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = centroid_distances)
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid  / Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#6BB2CD"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("Hemocyte distance to Abdomen centroid") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#6BB2CD"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
### Zero-scaled hemocyte distances after area-normalization and log-scaling
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = -log10(centroid_distances/Area.µm.2))
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
## Zero center all abdomen centroids and scale hemocyte centroids in each abdomen
merged_scaled <- merged  %>%
mutate("Centroid_X_hm_scaled" = Centroid_X_hm - Centroid_X_ab) %>%
mutate("Centroid_Y_hm_scaled" = Centroid_Y_hm - Centroid_Y_ab) %>%
select(Image_ab,Centroid_X_hm_scaled,Centroid_Y_hm_scaled,condition,centroid_distances, Area.µm.2)
### Zero-scaled hemocyte distances after area-normalization and log-scaling
merged_scaled_areanormed_log <- merged_scaled %>% mutate(centroid_distances_scaled = -log10(centroid_distances/Area.µm.2))
mean_centroid_distance <- plyr::ddply(merged_scaled_areanormed_log, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled_areanormed_log  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid/Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#F76D5E", "#6BB2CD"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#F76D5E", "#72D8FF")) +
theme_clean()
ggplot(merged_scaled, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values=c("skyblue","orange")) +
theme_clean()
ggplot(merged_scaled, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values= c("#F76D5E", "#72D8FF")) +
theme_clean()
ggplot(merged_scaled_areanormed_log, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values= c("#F76D5E", "#72D8FF")) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("Hemocyte distance to Abdomen centroid") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#924e8f", "#f9b428"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#924e8f", "#ffbf3c")) +
theme_clean()
### Zero-scaled hemocyte distances without area-normalization or log-scaling.
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = centroid_distances)
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("Hemocyte distance to Abdomen centroid") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#924e8f", "#f9b428"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("Hemocyte distance to Abdomen centroid") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#924e8f", "#D79309"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#924e8f", "#ffbf3c")) +
theme_clean()
## Zero center all abdomen centroids and scale hemocyte centroids in each abdomen
merged_scaled <- merged  %>%
mutate("Centroid_X_hm_scaled" = Centroid_X_hm - Centroid_X_ab) %>%
mutate("Centroid_Y_hm_scaled" = Centroid_Y_hm - Centroid_Y_ab) %>%
select(Image_ab,Centroid_X_hm_scaled,Centroid_Y_hm_scaled,condition,centroid_distances, Area.µm.2)
### Zero-scaled hemocyte distances without area-normalization or log-scaling.
merged_scaled <- merged_scaled %>% mutate(centroid_distances_scaled = centroid_distances)
mean_centroid_distance <- plyr::ddply(merged_scaled, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("Hemocyte distance to Abdomen centroid") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#924e8f", "#D79309"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#924e8f", "#ffbf3c")) +
theme_clean()
### Zero-scaled hemocyte distances after area-normalization and log-scaling
merged_scaled_areanormed_log <- merged_scaled %>% mutate(centroid_distances_scaled = -log10(centroid_distances/Area.µm.2))
mean_centroid_distance <- plyr::ddply(merged_scaled_areanormed_log, "condition", summarise, grp.mean=mean(centroid_distances_scaled))
merged_scaled_areanormed_log  %>% group_by(condition) %>% ggplot(aes(x=centroid_distances_scaled,fill=condition)) +
#geom_histogram() +
geom_density(alpha=0.9)+
ggtitle("Distribution of scaled hemocyte distances") +
xlab("-log10(Hemocyte distance to Abdomen centroid/Area of abdomen)") +
geom_vline(data=mean_centroid_distance, aes(xintercept=grp.mean),
color=c("#924e8f", "#D79309"), linetype="dashed", size=1) +
scale_fill_manual(values = c("#924e8f", "#ffbf3c")) +
theme_clean()
ggplot(merged_scaled, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values=c("#924e8f", "#ffbf3c")) +
theme_clean()
head(merged_scaled,10)
merged_scaled %>% mutate(Centroid_X_hm_scaled_an = Centroid_X_hm_scaled / Area.µm.2) %>% head(10)
merged_scaled %>% mutate(Centroid_X_hm_scaled_an = 100*(Centroid_X_hm_scaled / Area.µm.2) %>% head(10)
merged_scaled %>% mutate(Centroid_X_hm_scaled_an = 100*(Centroid_X_hm_scaled / Area.µm.2)) %>% head(10)
merged_scaled %>% mutate(Centroid_X_hm_scaled_an = 100*(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = 100*(Centroid_Y_hm_scaled / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = 100*(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = 100*(Centroid_Y_hm_scaled / Area.µm.2))
ggplot(merged_scaled_an, aes(x=Centroid_X_hm_scaled_an, y=Centroid_Y_hm_scaled_an,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values= c("#924e8f", "#72D8FF")) +
theme_clean()
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = -log10(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = -log10(Centroid_Y_hm_scaled / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = log10(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = log10(Centroid_Y_hm_scaled / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = sqrt(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = sqrt(Centroid_Y_hm_scaled / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = 100*(Centroid_X_hm_scaled / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = 100*(Centroid_Y_hm_scaled / Area.µm.2))
ggplot(merged_scaled_an, aes(x=Centroid_X_hm_scaled_an, y=Centroid_Y_hm_scaled_an,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values= c("#924e8f", "#72D8FF")) +
theme_clean()
ggplot(merged_scaled, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values=c("#924e8f", "#ffbf3c")) +
ggtitle("Hemocyte detections in abdomens") +
xlab("zero-scaled hemocyte Xco-ordinate") +
ylab("zero-scaled hemocyte Y co-ordinate") +
theme_clean()
ggplot(merged_scaled, aes(x=Centroid_X_hm_scaled, y=Centroid_Y_hm_scaled,group=condition))+
geom_point(aes(col=condition)) +
scale_color_manual(values=c("#924e8f", "#ffbf3c")) +
ggtitle("Hemocyte detections in abdomens") +
xlab("zero-scaled X co-ordinates of detected hemocytes") +
ylab("zero-scaled Y co-ordinates of detected hemocytes") +
theme_clean()
ggplot(merged_scaled_an, aes(x=Centroid_X_hm_scaled_an, y=Centroid_Y_hm_scaled_an,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = -log10(Centroid_X_hm_scaled+4000 / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = -log10(Centroid_Y_hm_scaled+4000 / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = -log10(Centroid_X_hm_scaled+14000 / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = -log10(Centroid_Y_hm_scaled+14000 / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = -log10(Centroid_X_hm_scaled+80000 / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an = -log10(Centroid_Y_hm_scaled+80000 / Area.µm.2))
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = (Centroid_X_hm_scaled+80000 / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an =(Centroid_Y_hm_scaled+80000 / Area.µm.2))
min(merged_scaled_an$Centroid_X_hm_scaled_an)
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = (Centroid_X_hm_scaled+1000 / Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an =(Centroid_Y_hm_scaled+1000 / Area.µm.2))
min(merged_scaled_an$Centroid_X_hm_scaled_an)
min(merged_scaled_an$Centroid_X_hm_scaled)
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = (Centroid_X_hm_scaled/ Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an =(Centroid_Y_hm_scaled / Area.µm.2))
min(merged_scaled_an$Centroid_X_hm_scaled)
min(merged_scaled_an$Centroid_X_hm_scaled_an)
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = (Centroid_X_hm_scaled+1000/ Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an =(Centroid_Y_hm_scaled+1000 / Area.µm.2))
min(merged_scaled_an$Centroid_X_hm_scaled_an)
head(merged_scaled_an,3)
merged_scaled_an %>% mutate(testx = Centroid_X_hm_scaled+100) %>%
mutate(testy = Centroid_Y_hm_scaled+100)
merged_scaled_an %>% mutate(testx = Centroid_X_hm_scaled+100) %>%
mutate(testy = Centroid_Y_hm_scaled+100) %>% head(4)
merged_scaled_an %>% mutate(testx = Centroid_X_hm_scaled+4000) %>%
mutate(testy = Centroid_Y_hm_scaled+4000) %>% head(4)
merged_scaled_an %>% mutate(testx = Centroid_X_hm_scaled+4000/Area.µm.2) %>%
mutate(testy = Centroid_Y_hm_scaled+4000/Area.µm.2) %>% head(4)
merged_scaled_an %>% mutate(testx = Centroid_X_hm_scaled+4000) %>%
mutate(testy = Centroid_Y_hm_scaled+4000) %>%
mutate(testxa = testx/Area.µm.2) %>%
mutate(testxa = testy/Area.µm.2) %>%
head(4)
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled+4000) %>%
mutate(y_shift = Centroid_Y_hm_scaled+4000) %>%
mutate(x_shift_arealog = -log10(x_shift/Area.µm.2)) %>%
mutate(y_shift_arealog = -log10(y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_an <- merged_scaled %>% mutate(Centroid_X_hm_scaled_an = (Centroid_X_hm_scaled+1000/ Area.µm.2)) %>%
mutate(Centroid_Y_hm_scaled_an =(Centroid_Y_hm_scaled+1000 / Area.µm.2))
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled+4000) %>%
mutate(y_shift = Centroid_Y_hm_scaled+4000) %>%
mutate(x_shift_arealog = log10(x_shift/Area.µm.2)) %>%
mutate(y_shift_arealog = log10(y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled+4000) %>%
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled+4000) %>%
)
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled+4000) %>%
mutate(y_shift = Centroid_Y_hm_scaled+4000) %>%
mutate(x_shift_arealog = x_shift/Area.µm.2) %>%
mutate(y_shift_arealog = (y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled) %>%
mutate(y_shift = Centroid_Y_hm_scaled) %>%
mutate(x_shift_arealog = x_shift/Area.µm.2) %>%
mutate(y_shift_arealog = (y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled) %>%
mutate(y_shift = Centroid_Y_hm_scaled) %>%
mutate(x_shift_arealog = 100*(x_shift/Area.µm.2)) %>%
mutate(y_shift_arealog = 100*(y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
merged_scaled_areanormed_log <- merged_scaled %>% mutate(x_shift = Centroid_X_hm_scaled) %>%
mutate(y_shift = Centroid_Y_hm_scaled) %>%
mutate(x_shift_arealog = 1000*(x_shift/Area.µm.2)) %>%
mutate(y_shift_arealog = 1000*(y_shift/Area.µm.2))
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("100*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("100*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
ggplot(merged_scaled_areanormed_log, aes(x=x_shift_arealog, y=y_shift_arealog,group=condition))+
geom_point(aes(col=condition)) +
ggtitle("Hemocyte detections in abdomens") +
xlab("1000*( zero-scaled hemocyte X co-ordinates / Area.µm.2)") +
ylab("1000*( zero-scaled hemocyte Y co-ordinates / Area.µm.2)") +
scale_color_manual(values= c("#924e8f", "#ffbf3c")) +
theme_clean()
library(tidyverse)
library(spatstat)
library(plotly)
library(ggthemes)
inputdir <- file.path("/Users/sbandya/Desktop/dev/hemocyte_recruitment_image_quantification/analysis/files/")
inputdir <- file.path("/Users/sbandya/Desktop/dev/hemocyte_recruitment_image_quantification/analysis/")
library(tidyverse)
library(spatstat)
library(plotly)
library(stringr)
library(ggthemes)
setwd("/Users/sbandya/Desktop/hemocyte_recruitment_image_quantification/code/")
inputdir <- file.path("/Users/sbandya/Desktop/hemocyte_recruitment_image_quantification/analysis/")
abdomen_measurements <- file.path("/Users/sbandya/Desktop/hemocyte_recruitment_image_quantification/analysis/annotation_measurements/")
hemocyte_measurements <- file.path("/Users/sbandya/Desktop/hemocyte_recruitment_image_quantification/analysis/detection_measurements/")
##############################################################################
# For each fly abdomen section
# set the abdomen centroid to (0,0)
# scale the hemocyte identifications with respect to (0,0)
##############################################################################
flyIDs <- c()
scaled_hemocyte_coordinates <- list()
for(file in list.files(abdomen_measurements)){
section_abdomen_measurements <- read.table(file = paste0(abdomen_measurements,file),sep="\t",header=TRUE)
section_hemocyte_measurements <-  read.table(file = paste0(hemocyte_measurements,file),sep="\t",header=TRUE)
section_hemocyte_measurements["centroid_x_zeroscaled"] <- section_hemocyte_measurements["Centroid.X.µm"] - section_abdomen_measurements["Centroid.X.µm"][,1]
section_hemocyte_measurements["centroid_y_zeroscaled"] <- section_hemocyte_measurements["Centroid.Y.µm"] - section_abdomen_measurements["Centroid.Y.µm"][,1]
basename <- gsub(".txt","",file)
section_hemocyte_measurements["z_stack"] <- str_split(basename,"_")[[1]][2]
flyIDs <- append(flyIDs,str_split(basename,"_")[[1]][1])
scaled_hemocyte_coordinates[[basename]] <- section_hemocyte_measurements
}
##############################################################################
# Reconstruct 3D fly abdomen from sections
# Create pp3 object for each 3D abdomen hemocyte coordinates
##############################################################################
scaled_hemocyte_coordinates_3D <- list()
for(fly in flyIDs){
#print(fly)
abdomen_section_IDS <- grep(fly, names(scaled_hemocyte_coordinates), value = TRUE)
all_zstacks_df <- bind_rows(scaled_hemocyte_coordinates[abdomen_section_IDS], .id = "Image")
spatstat_object <- pp3(x=all_zstacks_df$centroid_x_zeroscaled,
y=all_zstacks_df$centroid_y_zeroscaled,
z=as.numeric(all_zstacks_df$z_stack),
box3(xrange= c(min(all_zstacks_df$centroid_x_zeroscaled)-100,max(all_zstacks_df$centroid_x_zeroscaled)+100),
yrange= c(min(all_zstacks_df$centroid_y_zeroscaled)-100,max(all_zstacks_df$centroid_y_zeroscaled)+100),
zrange= c(0,max(as.numeric(all_zstacks_df$z_stack))+15)
#zrange= c(0,1000)
))
plot.pp3(spatstat_object)
scaled_hemocyte_coordinates_3D[[fly]] <- spatstat_object
#break
}
conditions <- append(rep("wellfed",33), rep("starved",34)) #Placeholder
scaled_hemocyte_coordinates_3D_hyperframe <- hyperframe(scaled_3D_coordinates = scaled_hemocyte_coordinates_3D,
samples = names(scaled_hemocyte_coordinates_3D),
experimental_condition = factor(conditions))
scaled_hemocyte_coordinates_3D_hyperframe
dim(scaled_hemocyte_coordinates_3D_hyperframe)
_
scaled_hemocyte_coordinates_3D_hyperframe$RipleyK <- with(scaled_hemocyte_coordinates_3D_hyperframe,
K3est(scaled_3D_coordinates, ratio=TRUE))
groupK <- anylapply(split(scaled_hemocyte_coordinates_3D_hyperframe$RipleyK,
scaled_hemocyte_coordinates_3D_hyperframe$samples), pool)
groupK
plot(groupK)
os <- osteo
os$K <- with(os, K3est(pts, ratio=TRUE))
Kanimal <- anylapply(split(os$K, os$id), pool)
plot(Kanimal)
unique(os$id)
plot(groupK)
groupK <- anylapply(split(scaled_hemocyte_coordinates_3D_hyperframe$RipleyK,
scaled_hemocyte_coordinates_3D_hyperframe$experimental_condition), pool)
plot(groupK)
scaled_hemocyte_coordinates_3D_hyperframe$G <- with(scaled_hemocyte_coordinates_3D_hyperframe,
G3est(scaled_3D_coordinates, ratio=TRUE))
warnings()
scaled_hemocyte_coordinates_3D_hyperframe$G <- with(scaled_hemocyte_coordinates_3D_hyperframe,
G3est(scaled_3D_coordinates))
groupG <- anylapply(split(scaled_hemocyte_coordinates_3D_hyperframe$G,
scaled_hemocyte_coordinates_3D_hyperframe$experimental_condition), pool)
scaled_hemocyte_coordinates_3D_hyperframe$G
scaled_hemocyte_coordinates_3D_hyperframe
groupG <- anylapply(split(scaled_hemocyte_coordinates_3D_hyperframe$G,
scaled_hemocyte_coordinates_3D_hyperframe$experimental_condition), pool)
groupG <- anylapply(split(scaled_hemocyte_coordinates_3D_hyperframe$G,
scaled_hemocyte_coordinates_3D_hyperframe$experimental_condition), pool)
scaled_hemocyte_coordinates_3D_hyperframe$L <- with(scaled_hemocyte_coordinates_3D_hyperframe,
L3est(scaled_3D_coordinates))
scaled_hemocyte_coordinates_3D_hyperframe$L <- with(scaled_hemocyte_coordinates_3D_hyperframe,
Lest(scaled_3D_coordinates))
